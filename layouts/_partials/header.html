<header class="{{ with .Site.Params.header.fixedTop }}sticky-top{{ end }} bg-primary {{ with .Site.Params.header.shadow }}shadow{{ end }}">
  <nav class="navbar navbar-expand-lg navbar-dark">
    <div class="container-fluid">

      {{/* SidebarToggler */}}
      {{ $sidebarState := false }}

      {{ if .Page.Params.sidebar }}
        {{ $sidebarState = .Page.Params.sidebar }}
      {{ else if and (.Page.IsHome) (.Site.Params.sidebar.home) }}
        {{ $sidebarState = .Site.Params.sidebar.home }}
      {{ else if and (.Page.IsSection) (.Site.Params.sidebar.section) }}
        {{ $sidebarState = .Site.Params.sidebar.section }}
      {{ else if and (.Page.IsPage) (.Site.Params.sidebar.single) }}
        {{ $sidebarState = .Site.Params.sidebar.single }}
      {{ end }}
      {{/* /SidebarToggler */}}

      {{ if $sidebarState }}
      <button class="navbar-toggler d-lg-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#{{ .Site.Params.sidebar.tableofcontentsID }}" aria-controls="{{ .Site.Params.sidebar.tableofcontentsID }}">
        {{ partial "icon" "panel-left-open" }}
      </button>
      {{ end }}

      {{/* Brand */}}
      {{ if or (.Site.Params.header.brandLogo) (.Site.Params.header.brandText) }}
        <a class="navbar-brand py-0" href="{{ .Site.BaseURL }}">

          {{/* Brand Logo */}}
          {{ if .Site.Params.header.brandLogo }}
            {{ $mainSVG := resources.Get .Site.Params.logo.mainSVG }}
            {{ $mainPNG := resources.Get .Site.Params.logo.mainPNG }}
            {{ $brandSVG := resources.Get .Site.Params.logo.brandSVG }}
            {{ $brandPNG := resources.Get .Site.Params.logo.brandPNG }}

            {{ $brandLogo := "" }}

            {{ if $brandSVG }}
              {{ $brandLogo = $brandSVG | resources.Copy (printf "img/logo/%s-brand.svg" (urlize (default "logo" .Site.Title))) }}
              {{ $brandLogo = $brandLogo.RelPermalink }}
            {{ else if $brandPNG }}
              {{ $brandLogo = $brandPNG.Resize "256x" | resources.Copy (printf "/img/logo/%s-brand.png" (urlize (default "logo" .Site.Title))) }}
              {{ $brandLogo = $brandLogo.RelPermalink }}
            {{ else if $mainSVG }}
              {{/* Use image generated in head */}}
              {{ $brandLogo = (printf "/img/logo/%s.svg" (urlize .Site.Title)) }}
            {{ else if $mainPNG }}
              {{ $brandLogo = (printf "/img/logo/%s256.png" (urlize .Site.Title)) }}
            {{ end }}

            {{ if $brandLogo }}
              <img src="{{ $brandLogo }}" alt="{{ .Site.Title }}" height="50" />
            {{ end }}
          {{ end }}

          {{/* Brand Text */}}
          {{ if .Site.Params.header.brandText }}
            {{ .Site.Title }}
          {{ end }}

        </a>
      {{ end }}

      {{/* Navbar Toggler */}}
      <button class="navbar-toggler collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#navbar-menu-items" aria-controls="navbar-menu-items" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-open">{{ partial "icon" "menu" }}</span>
        <span class="navbar-toggler-close">{{ partial "icon" "x" }}</span>
      </button>

      <div id="navbar-menu-items" class="navbar-collapse justify-content-end collapse text-end">
        <hr/>
        <ul class="navbar-nav fs-5">
          {{ if .Site.Menus.main }}
          {{ range sort .Site.Menus.main "Weight" }}
            <li class="nav-item">
              <a class="nav-link" href="{{ .URL }}" title="{{ .Title }}">
                {{ .Name }}
              </a>
            </li>
          {{ end }}
          {{ end }}

          {{/* Theme */}}
          <li class="nav-item">
            {{/* Theme Toggler */}}
            <button id="shock-theme-toggle" type="button" class="btn btn-secondary" title="Toggle Theme">
              <span class="theme-auto">{{ partial "icon" "contrast" }}</span>
              <span class="theme-light" style="display: none;">{{ partial "icon" "sun" }}</span>
              <span class="theme-dark" style="display: none;">{{ partial "icon" "moon" }}</span>
            </button>
          </li>

        </ul>
      </div>
    </div>
  </nav>
</header>
