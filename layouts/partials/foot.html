{{/* Bootstrap */}}
{{ $bootstrapJS := resources.Get "js/bootstrap/bootstrap.bundle.min.js" }}
{{ $bootstrapColorMode := resources.Get "js/bootstrap-colormode.js" }}

{{/* Shock */}}
{{ $shockJS := resources.Get "js/shock.js" }}

{{/* Site */}}
{{ $siteJS := resources.Get "js/site.js" }}

{{/* Source */}}
{{ $sourceJS := slice }}
{{ if .Site.Params.bootstrap.javascript }}
  {{ $sourceJS = slice $bootstrapJS $bootstrapColorMode $shockJS $siteJS }}
{{ else if or ($shockJS.Content) ($siteJS.Content) }}
  {{ $sourceJS = slice $shockJS $siteJS }}
{{ end }}

{{/* Main */}}
{{ $mainOpts := dict
  "minify" hugo.IsProduction
  "sourceMap" (cond hugo.IsProduction "" "external")
  "targetPath" "js/main.min.js"
}}

{{ if $sourceJS }}
  {{ $buildJS := $sourceJS | resources.Concat "js/main.js" | js.Build $mainOpts }}
  {{ $buildSRI := $buildJS | resources.Fingerprint "sha384" }}
  <script defer src="{{ $buildSRI.RelPermalink }}" integrity="{{ $buildSRI.Data.Integrity }}"></script>
{{ end }}
